//XMLkey = "ufabc-help-aluno-XML";
xml64  = 'PGFsdW5vPjxub21lPkZlcm5hbmRvIEZyZWl0YXMgQWx2ZXM8L25vbWU+PGVtYWlsPmZlcm5hbmRvLmZyZWl0YXNAYWx1bm8udWZhYmMuZWR1LmJyPC9lbWFpbD48cmE+MjEwMjcyMTE8L3JhPjxjdXJzbz5CYWNoYXJlbGFkbyBlbSBDaepuY2lhIGUgVGVjbm9sb2dpYTwvY3Vyc28+PGhpc3Rvcmljbz48cXVhZHJpbWVzdHJlIGFubz0iMjAxMSIgbnVtPSIyIj48ZGlzY2lwbGluYSBjb2RpZ289IkJDMDAwNSI+PG5vbWU+QmFzZXMgQ29tcHV0YWNpb25haXMgZGEgQ2nqbmNpYTwvbm9tZT48Y3JlZGl0b3M+MjwvY3JlZGl0b3M+PGNvbmNlaXRvPkE8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PYnJpZ2F083JpYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkJDMDAwMSI+PG5vbWU+QmFzZSBFeHBlcmltZW50YWwgZGFzIENp6m5jaWFzIE5hdHVyYWlzPC9ub21lPjxjcmVkaXRvcz4zPC9jcmVkaXRvcz48Y29uY2VpdG8+QzwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9icmlnYXTzcmlhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwMzA0Ij48bm9tZT5PcmlnZW0gZGEgVmlkYSBlIERpdmVyc2lkYWRlIGRvcyBTZXJlcyBWaXZvczwvbm9tZT48Y3JlZGl0b3M+MzwvY3JlZGl0b3M+PGNvbmNlaXRvPkI8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PYnJpZ2F083JpYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkJDMjAwMSI+PG5vbWU+SW5pY2lh5+NvIOAgUGVzcXVpc2EgQ2llbnTtZmljYSBJPC9ub21lPjxjcmVkaXRvcz4yPC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9w5+NvIExpbWl0YWRhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwMDAzIj48bm9tZT5CYXNlcyBNYXRlbeF0aWNhczwvbm9tZT48Y3JlZGl0b3M+NDwvY3JlZGl0b3M+PGNvbmNlaXRvPkI8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PYnJpZ2F083JpYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkJDMDEwMiI+PG5vbWU+RXN0cnV0dXJhIGRhIE1hdOlyaWE8L25vbWU+PGNyZWRpdG9zPjM8L2NyZWRpdG9zPjxjb25jZWl0bz5CPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PC9xdWFkcmltZXN0cmU+PHF1YWRyaW1lc3RyZSBhbm89IjIwMTEiIG51bT0iMyI+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzA0MDQiPjxub21lPkdlb21ldHJpYSBBbmFs7XRpY2E8L25vbWU+PGNyZWRpdG9zPjM8L2NyZWRpdG9zPjxjb25jZWl0bz5BPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzA0MDIiPjxub21lPkZ1buf1ZXMgZGUgVW1hIFZhcmnhdmVsPC9ub21lPjxjcmVkaXRvcz40PC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9icmlnYXTzcmlhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwMjA4Ij48bm9tZT5GZW70bWVub3MgTWVj4m5pY29zPC9ub21lPjxjcmVkaXRvcz41PC9jcmVkaXRvcz48Y29uY2VpdG8+QjwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9icmlnYXTzcmlhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwMzA2Ij48bm9tZT5UcmFuc2Zvcm1h5/VlcyBub3MgU2VyZXMgVml2b3MgZSBBbWJpZW50ZTwvbm9tZT48Y3JlZGl0b3M+MzwvY3JlZGl0b3M+PGNvbmNlaXRvPkI8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PYnJpZ2F083JpYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkJDMDUwNCI+PG5vbWU+TmF0dXJlemEgZGEgSW5mb3JtYefjbzwvbm9tZT48Y3JlZGl0b3M+MzwvY3JlZGl0b3M+PGNvbmNlaXRvPkI8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PYnJpZ2F083JpYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48L3F1YWRyaW1lc3RyZT48cXVhZHJpbWVzdHJlIGFubz0iMjAxMiIgbnVtPSIxIj48ZGlzY2lwbGluYSBjb2RpZ289IkJDMDMwNyI+PG5vbWU+VHJhbnNmb3JtYef1ZXMgUXXtbWljYXM8L25vbWU+PGNyZWRpdG9zPjU8L2NyZWRpdG9zPjxjb25jZWl0bz5DPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzIwMDIiPjxub21lPkluaWNpYefjbyDgIFBlc3F1aXNhIENpZW507WZpY2EgSUk8L25vbWU+PGNyZWRpdG9zPjI8L2NyZWRpdG9zPjxjb25jZWl0bz5CPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T3Dn428gTGltaXRhZGE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzA0MDUiPjxub21lPkludHJvZHXn428g4HMgRXF1Yef1ZXMgRGlmZXJlbmNpYWlzIE9yZGlu4XJpYXM8L25vbWU+PGNyZWRpdG9zPjQ8L2NyZWRpdG9zPjxjb25jZWl0bz5BPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzAyMDUiPjxub21lPkZlbvRtZW5vcyBU6XJtaWNvczwvbm9tZT48Y3JlZGl0b3M+NDwvY3JlZGl0b3M+PGNvbmNlaXRvPkE8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PYnJpZ2F083JpYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkJDMDAwNCI+PG5vbWU+QmFzZXMgRXBpc3RlbW9s82dpY2FzIGRhIENp6m5jaWEgTW9kZXJuYTwvbm9tZT48Y3JlZGl0b3M+MzwvY3JlZGl0b3M+PGNvbmNlaXRvPkE8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PYnJpZ2F083JpYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkJDMDUwNSI+PG5vbWU+UHJvY2Vzc2FtZW50byBkYSBJbmZvcm1h5+NvPC9ub21lPjxjcmVkaXRvcz41PC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9icmlnYXTzcmlhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjwvcXVhZHJpbWVzdHJlPjxxdWFkcmltZXN0cmUgYW5vPSIyMDEyIiBudW09IjIiPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwNjAyIj48bm9tZT5Fc3RydXR1cmEgZSBEaW7ibWljYSBTb2NpYWw8L25vbWU+PGNyZWRpdG9zPjM8L2NyZWRpdG9zPjxjb25jZWl0bz5BPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzAyMDkiPjxub21lPkZlbvRtZW5vcyBFbGV0cm9tYWdu6XRpY29zPC9ub21lPjxjcmVkaXRvcz41PC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9icmlnYXTzcmlhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwNDA3Ij48bm9tZT5GdW7n9WVzIGRlIFbhcmlhcyBWYXJp4XZlaXM8L25vbWU+PGNyZWRpdG9zPjQ8L2NyZWRpdG9zPjxjb25jZWl0bz5BPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzAzMDgiPjxub21lPlRyYW5zZm9ybWHn9WVzIEJpb3F17W1pY2FzPC9ub21lPjxjcmVkaXRvcz41PC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9icmlnYXTzcmlhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwMjA3Ij48bm9tZT5FbmVyZ2lhOiBPcmlnZW5zLCBDb252ZXJz428gZSBVc288L25vbWU+PGNyZWRpdG9zPjI8L2NyZWRpdG9zPjxjb25jZWl0bz5CPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzA1MDYiPjxub21lPkNvbXVuaWNh5+NvIGUgUmVkZXM8L25vbWU+PGNyZWRpdG9zPjM8L2NyZWRpdG9zPjxjb25jZWl0bz5DPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PC9xdWFkcmltZXN0cmU+PHF1YWRyaW1lc3RyZSBhbm89IjIwMTIiIG51bT0iMyI+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzE0MjUiPjxub21lPsFsZ2VicmEgTGluZWFyPC9ub21lPjxjcmVkaXRvcz42PC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9w5+NvIExpbWl0YWRhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwNDA2Ij48bm9tZT5JbnRyb2R15+NvIOAgUHJvYmFiaWxpZGFkZSBlIOAgRXN0YXTtc3RpY2E8L25vbWU+PGNyZWRpdG9zPjM8L2NyZWRpdG9zPjxjb25jZWl0bz5BPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzIwMDMiPjxub21lPkluaWNpYefjbyDgIFBlc3F1aXNhIENpZW507WZpY2EgSUlJPC9ub21lPjxjcmVkaXRvcz4yPC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9w5+NvIExpbWl0YWRhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwMTAzIj48bm9tZT5G7XNpY2EgUXXibnRpY2E8L25vbWU+PGNyZWRpdG9zPjM8L2NyZWRpdG9zPjxjb25jZWl0bz5BPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzExMDUiPjxub21lPk1hdGVyaWFpcyBlIFN1YXMgUHJvcHJpZWRhZGVzPC9ub21lPjxjcmVkaXRvcz40PC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9w5+NvIExpbWl0YWRhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwNjAzIj48bm9tZT5DaepuY2lhLCBUZWNub2xvZ2lhIGUgU29jaWVkYWRlPC9ub21lPjxjcmVkaXRvcz4zPC9jcmVkaXRvcz48Y29uY2VpdG8+QjwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9icmlnYXTzcmlhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjwvcXVhZHJpbWVzdHJlPjxxdWFkcmltZXN0cmUgYW5vPSIyMDEzIiBudW09IjEiPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMxNDE5Ij48bm9tZT5D4WxjdWxvIE51belyaWNvPC9ub21lPjxjcmVkaXRvcz40PC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9w5+NvIExpbWl0YWRhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwMDAyIj48bm9tZT5Qcm9qZXRvIERpcmlnaWRvPC9ub21lPjxjcmVkaXRvcz4yPC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9icmlnYXTzcmlhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMwMTA0Ij48bm9tZT5JbnRlcmHn9WVzIEF09G1pY2FzIGUgTW9sZWN1bGFyZXM8L25vbWU+PGNyZWRpdG9zPjM8L2NyZWRpdG9zPjxjb25jZWl0bz5CPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T2JyaWdhdPNyaWE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzEzMDkiPjxub21lPlRlcm1vZGlu4m1pY2EgQXBsaWNhZGE8L25vbWU+PGNyZWRpdG9zPjQ8L2NyZWRpdG9zPjxjb25jZWl0bz5CPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T3Dn428gTGltaXRhZGE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzE3MTAiPjxub21lPkludHJvZHXn428g4HMgRW5nZW5oYXJpYXM8L25vbWU+PGNyZWRpdG9zPjI8L2NyZWRpdG9zPjxjb25jZWl0bz5BPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T3Dn428gTGltaXRhZGE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzE3MTEiPjxub21lPkVuZ2VuaGFyaWEgRWNvbvRtaWNhPC9ub21lPjxjcmVkaXRvcz4zPC9jcmVkaXRvcz48Y29uY2VpdG8+QzwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9w5+NvIExpbWl0YWRhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMxNDE2Ij48bm9tZT5GdW5kYW1lbnRvcyBkZSBEZXNlbmhvIGUgUHJvamV0bzwvbm9tZT48Y3JlZGl0b3M+NDwvY3JlZGl0b3M+PGNvbmNlaXRvPkE8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PcOfjbyBMaW1pdGFkYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48L3F1YWRyaW1lc3RyZT48cXVhZHJpbWVzdHJlIGFubz0iMjAxMyIgbnVtPSIyIj48ZGlzY2lwbGluYSBjb2RpZ289Ik5IMjA0MyI+PG5vbWU+Ru1zaWNhIENvbXB1dGFjaW9uYWw8L25vbWU+PGNyZWRpdG9zPjQ8L2NyZWRpdG9zPjxjb25jZWl0bz5BPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+TGl2cmUgRXNjb2xoYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkJDMTEwNCI+PG5vbWU+TWVj4m5pY2EgZG9zIFPzbGlkb3M8L25vbWU+PGNyZWRpdG9zPjQ8L2NyZWRpdG9zPjxjb25jZWl0bz5BPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+T3Dn428gTGltaXRhZGE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PGRpc2NpcGxpbmEgY29kaWdvPSJCQzE1MTkiPjxub21lPkNpcmN1aXRvcyBFbOl0cmljb3MgZSBGb3T0bmljYTwvbm9tZT48Y3JlZGl0b3M+NDwvY3JlZGl0b3M+PGNvbmNlaXRvPkE8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PcOfjbyBMaW1pdGFkYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkJDMTUwNyI+PG5vbWU+SW5zdHJ1bWVudGHn428gZSBDb250cm9sZTwvbm9tZT48Y3JlZGl0b3M+NDwvY3JlZGl0b3M+PGNvbmNlaXRvPkI8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PcOfjbyBMaW1pdGFkYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48L3F1YWRyaW1lc3RyZT48cXVhZHJpbWVzdHJlIGFubz0iMjAxMyIgbnVtPSIzIj48ZGlzY2lwbGluYSBjb2RpZ289IkVOMzcwNyI+PG5vbWU+Q2lyY3VpdG9zIEhpZHLhdWxpY29zIGUgUG5ldW3hdGljb3M8L25vbWU+PGNyZWRpdG9zPjQ8L2NyZWRpdG9zPjxjb25jZWl0bz5CPC9jb25jZWl0bz48c2l0dWFjYW8+QXByb3ZhZG88L3NpdHVhY2FvPjxjYXRlZ29yaWE+TGl2cmUgRXNjb2xoYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkVOMjYwNyI+PG5vbWU+VHJhbnNmb3JtYWRhcyBlbSBTaW5haXMgZSBTaXN0ZW1hcyBMaW5lYXJlczwvbm9tZT48Y3JlZGl0b3M+NDwvY3JlZGl0b3M+PGNvbmNlaXRvPkI8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PcOfjbyBMaW1pdGFkYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkVOMjcwMyI+PG5vbWU+Q2lyY3VpdG9zIEVs6XRyaWNvcyBJPC9ub21lPjxjcmVkaXRvcz41PC9jcmVkaXRvcz48Y29uY2VpdG8+QTwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPk9w5+NvIExpbWl0YWRhPC9jYXRlZ29yaWE+PC9kaXNjaXBsaW5hPjxkaXNjaXBsaW5hIGNvZGlnbz0iQkMxNzA3Ij48bm9tZT5N6XRvZG9zIEV4cGVyaW1lbnRhaXMgZW0gRW5nZW5oYXJpYTwvbm9tZT48Y3JlZGl0b3M+MzwvY3JlZGl0b3M+PGNvbmNlaXRvPkE8L2NvbmNlaXRvPjxzaXR1YWNhbz5BcHJvdmFkbzwvc2l0dWFjYW8+PGNhdGVnb3JpYT5PcOfjbyBMaW1pdGFkYTwvY2F0ZWdvcmlhPjwvZGlzY2lwbGluYT48ZGlzY2lwbGluYSBjb2RpZ289IkVOMzcyMSI+PG5vbWU+VGVvcmlhIGRlIENvbnRyb2xlINN0aW1vPC9ub21lPjxjcmVkaXRvcz4zPC9jcmVkaXRvcz48Y29uY2VpdG8+RDwvY29uY2VpdG8+PHNpdHVhY2FvPkFwcm92YWRvPC9zaXR1YWNhbz48Y2F0ZWdvcmlhPkxpdnJlIEVzY29saGE8L2NhdGVnb3JpYT48L2Rpc2NpcGxpbmE+PC9xdWFkcmltZXN0cmU+PC9oaXN0b3JpY28+PC9hbHVubz4=';
//xml64  = "data:application/xml;base64," + xml64;
loadScript('javascripts/URI.js', null);
loadScript('javascripts/jx.js',  null);

function loadScript(url, callback)
{
    // Adding the script tag to the head as suggested before
    var head    = document.getElementsByTagName('head')[0];
    var script  = document.createElement('script');
    script.type = 'text/javascript';
    script.src  = url;

    // Then bind the event to the callback function.
    // There are several events for cross browser compatibility.
    script.onreadystatechange = callback;
    script.onload = callback;

    // Fire the loading
    head.appendChild(script);
}

onload = function()
{
    /*
    XMLstr = getXMLstr();
    XML    = new xmlClass(XMLstr);
    aluno  = new alunoClass(XML);
    fillData(aluno);
    changeRowColor(aluno.nome);
    */
    // type, id, title, className, innerHTML, onclick, target, before, after
    insertElement('button',
                  'post',
                  null,
                  null,
                  'Enviar',
                  sendMessage,
                  'conteudo',
                  'page',
                  null);
}

function sendMessage(message, targetOrigin)
{
    message      = 'teste=1&aluno=' + encodeURIComponent(xml64) + '&abc=123';
    targetOrigin = '*';
    window.postMessage(message, targetOrigin);
}

function receiveMessage(event)
{
    //if (event.origin !== "http://example.com:8080") return;
    //event.source.postMessage("hi there yourself!  the secret response is: rheeeeet!", event.origin);
    alert('Mensagem recebida');
    XMLstr = getXMLstr(event.data);
    XML    = new xmlClass(XMLstr);
    aluno  = new alunoClass(XML);
    fillData(aluno);
    changeRowColor(aluno.nome);
}

window.addEventListener("message", receiveMessage, false);

function getXMLstr(data)
{
    //return getStoreValue(XMLkey);
    
    //return atob(xml64);
    ///*
    uri  = new URI('?' + data);
    hash = uri.search(true).aluno;
    hash = decodeURIComponent(hash);
    return atob(hash);
    //*/
    //jx.load("www.google.com?lorem=ipsum&name=binny", null, "text", "POST");
}

function xmlClass(str)
{
    var doc;
    this.loadXML = function(str)
    {
        this.doc = parseXML(str);
    }
    this.getFirstElement = function(tag)
    {
        try
        {
            return this.doc.getElementsByTagName(tag)[0].childNodes[0];
        }
        catch(e)
        {
            return null
        }
    }
    this.getFirstElementValue = function(tag)
    {
        try
        {
            return this.getFirstElement(tag).nodeValue;
        }
        catch(e)
        {
            return null
        }
    }
    this.getElements = function(tag)
    {
        try
        {
            return this.doc.getElementsByTagName(tag);
        }
        catch(e)
        {
            return null
        }
    }
    this.loadXML(str);
}
/*
function getStoreValue(key) {
    if (localStorage)
         return localStorage.getItem(key);
    else return $.cookies.get(key);
}
*/
function parseXML(s)
{
    if (window.DOMParser)
        xmlDOC = new DOMParser().parseFromString(s, "text/xml");
    else // Internet Explorer
    {
        xmlDOC = new ActiveXObject("Microsoft.XMLDOM");
        xmlDOC.async = false;
        xmlDOC.loadXML(s);
    }
    return xmlDOC;
}

function alunoClass(xmlDOC)
{
    var nome,
        email,
        RA,
        curso,
        quadrimestre;
    this.loadFromXML = function(xmlDOC)
    {
        this.nome  = xmlDOC.getFirstElementValue('nome');   if (this.nome  === null) this.nome  = '';
        this.email = xmlDOC.getFirstElementValue('email');  if (this.email === null) this.email = '';
        this.RA    = xmlDOC.getFirstElementValue('ra');     if (this.RA    === null) this.RA    = '';
        this.curso = xmlDOC.getFirstElementValue('curso');  if (this.curso === null) this.curso = '';
        this.quadrimestre = [];
        qr = xmlDOC.getElements('quadrimestre');
        for (q = 0; q < qr.length; q++)
            this.quadrimestre.push(new quadrimestreClass(qr[q]));
    }
    this.loadFromXML(xmlDOC);
}

function quadrimestreClass(xml)
{
    var ano,
        n,
        disciplina;
    this.parse = function(xml)
    {
        this.ano = xml.getAttribute('ano');
        this.n   = xml.getAttribute('num');
        this.disciplina = [];
        dr = xml.getElementsByTagName('disciplina');
        for (d = 0; d < dr.length; d++)
            this.disciplina.push(new disciplinaClass(dr[d]));
    }
    this.parse(xml);
}

function disciplinaClass(xml)
{
    var codigo,
        nome,
        creditos,
        conceito,
        situacao,
        categoria;
    this.parse = function(xml)
    {
        this.codigo    = xml.getAttribute('codigo');
        this.nome      = xml.getElementsByTagName('nome'     )[0].childNodes[0].nodeValue;
        this.creditos  = xml.getElementsByTagName('creditos' )[0].childNodes[0].nodeValue;
        this.conceito  = xml.getElementsByTagName('conceito' )[0].childNodes[0].nodeValue;
        this.situacao  = xml.getElementsByTagName('situacao' )[0].childNodes[0].nodeValue;
        this.categoria = xml.getElementsByTagName('categoria')[0].childNodes[0].nodeValue;
    }
    this.parse(xml);
}

function fillData(aluno)
{
    document.getElementById('nome').innerHTML  = aluno.nome;
    //document.getElementById('email').innerHTML = aluno.email;
    document.getElementById('RA').innerHTML    = aluno.RA;
    document.getElementById('curso').innerHTML = aluno.curso;
    d_acc = 0;
    ficha_individual = document.getElementsByClassName('ficha_individual')[0];
    for (q = 0; q < aluno.quadrimestre.length; q++)
    {
        qn = insertElement('tr',
                           'quadrimestre ' + q,
                           null,
                           'quadrimestre',
                           '<td colspan=6 class="ano_periodo">' + aluno.quadrimestre[q].n + ' de ' + aluno.quadrimestre[q].ano + '</td>',
                           null,
                           ficha_individual,
                           null,
                           'cabecalho');
        for (d = 0; d < aluno.quadrimestre[q].disciplina.length; d++)
        {
            innerHTML = '<td>' + aluno.quadrimestre[q].disciplina[d].codigo + '</td>' + '\n' +
                        '<td style="text-align: left;">' + aluno.quadrimestre[q].disciplina[d].nome + '</td>' + '\n' +
                        '<td>' + aluno.quadrimestre[q].disciplina[d].creditos + '</td>' + '\n' +
                        '<td>' + aluno.quadrimestre[q].disciplina[d].conceito + '</td>' + '\n' +
                        '<td>' + aluno.quadrimestre[q].disciplina[d].situacao + '</td>' + '\n' +
                        '<td>' + aluno.quadrimestre[q].disciplina[d].categoria + '</td>';

            dn = insertElement('tr',
                               'disciplina ' + d_acc++,
                               null,
                               'disciplina',
                               innerHTML,
                               null,
                               ficha_individual,
                               null,
                               qn);
        }
    }
}

function insertElement(type, id, title, className, innerHTML, onclick, target, before, after)
{
    elementTarget = getElement(target);
    if (elementTarget !== null)
    {
        elementBefore = getElement(before);
        elementAfter  = getElement(after);
        if (elementBefore === null &&
            elementAfter  !== null)                 elementBefore = elementAfter.nextSibling;
        
        element = document.createElement(type);
        if (id        !== null && id        != '')  element.id        = id;
        if (title     !== null && title     != '')  element.title     = title;
        if (className !== null && className != '')  element.className = className;
        if (innerHTML !== null && innerHTML != '')  element.innerHTML = innerHTML;
        if (onclick   !== null && onclick   != '')  element.onclick   = onclick;
        
        if (elementBefore !== null)                 elementTarget.insertBefore(element, elementBefore);
        else                                        elementTarget.appendChild(element);
        return document.getElementById(id);
    }
    return null;
}

function getElement(element)
{
    elementObj = null;
    if (element !== null)
    {
        if (typeof element == 'string' && element != '')  elementObj = document.getElementById(element);
        else  if (typeof element == 'object')             elementObj = element;
    }
    return elementObj;
}

function changeRowColor(str)
{

    bgColor = intToRGB(hashCode(str));
    insertCSS('#conteudo tr:hover td { background: #' + bgColor + '; }');

    cp      = document.getElementsByClassName('coeficientes')[0].childNodes[1].childNodes[2].childNodes[1];
    cpColor = document.defaultView.getComputedStyle(cp, null)['color'];
    cpColor = rgbToString(cpColor);
    //if (getBrightness(0, bgColor) <= 255*.7)
    //    bgColor = rgbBrightness(bgColor, .50);
    if (getBrightness(0, bgColor) <= 255*.7 ||
        rgbProximity(bgColor, cpColor) > .80)
        insertCSS('#conteudo tr:hover td { color: #FFFFFF; }' + '\n' +
                  '#conteudo tr.quadrimestre:hover td { color: initial; }');
}

function insertCSS(css)
{
    head  = document.head || document.getElementsByTagName('head')[0];
    style = document.createElement('style');
    style.type = 'text/css';
    if (style.styleSheet)
         style.styleSheet.cssText = css;
    else style.appendChild(document.createTextNode(css));
    head.appendChild(style);
}

function hashCode(str)
{
    hash = 0;
    for (i = 0; i < str.length; i++)
       hash = str.charCodeAt(i) + ((hash << 5) - hash);
    return hash;
} 

function intToRGB(i)
{
    r = (i >> 16) & 0xFF;
    g = (i >>  8) & 0xFF;
    b =  i        & 0xFF;
    //return ((i >> 24) & 0xFF).toString(16) +
    return (r <= 0xF ? '0' : '') + r.toString(16) +
           (g <= 0xF ? '0' : '') + g.toString(16) +
           (b <= 0xF ? '0' : '') + b.toString(16);
}

function rgbBrightness(hex, percent)
{
    rgb = hexToRGB(hex);
    return ((0|(1<<8) + rgb[0] + (256 - rgb[0]) * percent / (percent > 1 ? 100 : 1)).toString(16)).substr(1) +
           ((0|(1<<8) + rgb[1] + (256 - rgb[1]) * percent / (percent > 1 ? 100 : 1)).toString(16)).substr(1) +
           ((0|(1<<8) + rgb[2] + (256 - rgb[2]) * percent / (percent > 1 ? 100 : 1)).toString(16)).substr(1);
}

function hexToRGB(hex)
{
    // strip the leading # if it's there
    hex = hex.replace(/^\s*#|\s*$/g, '');

    // convert 3 char codes --> 6, e.g. `E0F` --> `EE00FF`
    if(hex.length == 3)
        hex = hex.replace(/(.)/g, '$1$1');
    var r = parseInt(hex.substr(0, 2), 16),
        g = parseInt(hex.substr(2, 2), 16),
        b = parseInt(hex.substr(4, 2), 16);
    return [r, g, b];
}

function getBrightness(typeOfCalc, hex)
{
    rgb = hexToRGB(hex);
    switch (typeOfCalc)
    {
        case  0: return 0.2126*rgb[0] + 0.7152*rgb[1] + 0.0722*rgb[2];                  // Luminance (standard, objective)
        case  1: return 0.299 *rgb[0] + 0.587 *rgb[1] + 0.114 *rgb[2];                  // Luminance (perceived option 1)
        case  2: return Math.sqrt( 0.241*rgb[0]^2 + 0.691*rgb[1]^2 + 0.068*rgb[2]^2 );  // Luminance (perceived option 2)
        default: return 0.2126*rgb[0] + 0.7152*rgb[1] + 0.0722*rgb[2];                  // Luminance (standard, objective)
    }
}

function rgbToString(rgb)
{
    ini = rgb.indexOf('(') + 1;
    end = rgb.indexOf(',');
    r   = rgb.substring(ini, end);

    ini = end + 1;
    end = rgb.lastIndexOf(',');
    g   = rgb.substring(ini, end);

    ini = end + 1;
    end = rgb.lastIndexOf(')');
    b   = rgb.substring(ini, end);
    
    num =  (parseInt(r) << 16) |
           (parseInt(g) <<  8) |
            parseInt(b);
    return intToRGB(num);
}

function rgbProximity(hex1, hex2)
{
    rgb1 = hexToRGB(hex1);
    rgb2 = hexToRGB(hex2);
    rp = 1 - Math.abs(rgb1[0] - rgb2[0]) / 0xFF;
    gp = 1 - Math.abs(rgb1[1] - rgb2[1]) / 0xFF;
    bp = 1 - Math.abs(rgb1[2] - rgb2[2]) / 0xFF;
    return Math.min(Math.min(rp, gp), bp);
}